<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRYOUT TPA PAKET 3</title>
    <style>
        /* Semua style sebelumnya tetap sama */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .timer-container {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 8px;
            text-align: center;
            min-width: 200px;
        }
        
        #timer {
            font-size: 28px;
            font-weight: bold;
            font-family: monospace;
        }
        
        .timer-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .warning {
            color: #ffcc00;
        }
        
        .danger {
            color: #ff4757;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .sidebar {
            flex: 1;
            min-width: 250px;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            height: fit-content;
        }
        
        .questions-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .question-number {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f1f5f9;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #e2e8f0;
            font-weight: 500;
        }
        
        .question-number:hover {
            background-color: #e2e8f0;
            transform: translateY(-2px);
        }
        
        .question-number.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .question-number.answered {
            background-color: #10b981;
            color: white;
            border-color: #10b981;
        }
        
        .question-number.marked {
            background-color: #f59e0b;
            color: white;
            border-color: #f59e0b;
        }
        
        .question-container {
            flex: 3;
            min-width: 300px;
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        
        .section-title {
            color: #1e3c72;
            padding-bottom: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
            font-size: 20px;
        }
        
        .question-text {
            font-size: 18px;
            margin-bottom: 25px;
            line-height: 1.8;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .option:hover {
            background-color: #f8fafc;
            border-color: #cbd5e1;
        }
        
        .option.selected {
            background-color: #dbeafe;
            border-color: #3b82f6;
        }
        
        .option-label {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background-color: #f1f5f9;
            border-radius: 50%;
            margin-right: 15px;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .option.selected .option-label {
            background-color: #3b82f6;
            color: white;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 16px;
        }
        
        .btn-primary {
            background-color: #3b82f6;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2563eb;
        }
        
        .btn-secondary {
            background-color: #f1f5f9;
            color: #475569;
        }
        
        .btn-secondary:hover {
            background-color: #e2e8f0;
        }
        
        .btn-success {
            background-color: #10b981;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #059669;
        }
        
        .btn-danger {
            background-color: #ef4444;
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #dc2626;
        }
        
        .btn-mark {
            background-color: #f59e0b;
            color: white;
            margin-left: 10px;
        }
        
        .btn-mark:hover {
            background-color: #d97706;
        }
        
        .btn-explanation {
            background-color: #8b5cf6;
            color: white;
        }
        
        .btn-explanation:hover {
            background-color: #7c3aed;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 10px;
        }
        
        .exam-info {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e2e8f0;
        }
        
        .info-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .info-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
            margin-right: 10px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .modal h2 {
            color: #1e3c72;
            margin-bottom: 15px;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
        
        .result-container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            max-width: 800px;
            margin: 30px auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .result-title {
            text-align: center;
            color: #1e3c72;
            margin-bottom: 30px;
        }
        
        .result-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-box {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #1e3c72;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #64748b;
            font-size: 14px;
        }
        
        .section-result {
            margin-bottom: 25px;
        }
        
        .section-result h3 {
            color: #334155;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .section-details {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        
        .detail-item {
            background-color: #f1f5f9;
            padding: 10px;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .detail-item span {
            font-weight: bold;
            color: #1e3c72;
        }
        
        .result-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        /* Styling untuk halaman pembahasan */
        .explanation-container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            max-width: 1000px;
            margin: 30px auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .explanation-title {
            text-align: center;
            color: #1e3c72;
            margin-bottom: 30px;
        }
        
        .explanation-section {
            margin-bottom: 40px;
        }
        
        .explanation-section h3 {
            color: #1e3c72;
            padding-bottom: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e2e8f0;
        }
        
        .explanation-item {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3b82f6;
        }
        
        .explanation-item.correct {
            border-left-color: #10b981;
        }
        
        .explanation-item.incorrect {
            border-left-color: #ef4444;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .question-number-badge {
            background-color: #3b82f6;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 14px;
        }
        
        .status-correct {
            background-color: #10b981;
            color: white;
        }
        
        .status-incorrect {
            background-color: #ef4444;
            color: white;
        }
        
        .user-answer {
            background-color: #e2e8f0;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            font-weight: bold;
        }
        
        .correct-answer {
            background-color: #d1fae5;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: bold;
            color: #065f46;
        }
        
        .explanation-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }
        
        .explanation-content h4 {
            color: #1e3c72;
            margin-bottom: 10px;
        }
        
        .explanation-content p {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .explanation-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        /* Halaman Awal (Input Data Peserta) */
        .start-container {
            background-color: white;
            border-radius: 10px;
            padding: 40px;
            max-width: 600px;
            margin: 50px auto;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .start-title {
            text-align: center;
            color: #1e3c72;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #334155;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .start-instructions {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            border-left: 4px solid #3b82f6;
        }
        
        .start-instructions h3 {
            color: #1e3c72;
            margin-bottom: 10px;
        }
        
        .start-instructions ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .start-instructions li {
            margin-bottom: 8px;
        }
        
        .info-box {
            background-color: #fef3c7;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #f59e0b;
        }
        
        /* Halaman Hasil dengan Data Peserta */
        .participant-info {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #3b82f6;
        }
        
        .participant-info h3 {
            color: #1e3c72;
            margin-bottom: 15px;
        }
        
        .participant-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .participant-detail {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .participant-detail label {
            font-weight: 600;
            color: #64748b;
            font-size: 14px;
            display: block;
            margin-bottom: 5px;
        }
        
        .participant-detail span {
            font-size: 16px;
            color: #1e3c72;
            font-weight: 600;
        }
        
        .score-breakdown {
            background-color: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .score-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .score-table th {
            background-color: #e2e8f0;
            padding: 12px 15px;
            text-align: left;
            color: #334155;
            font-weight: 600;
            border-bottom: 2px solid #cbd5e1;
        }
        
        .score-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .score-table tr:last-child td {
            border-bottom: none;
        }
        
        .score-table tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .score-table .total-row {
            background-color: #dbeafe;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .timer-container {
                margin-top: 15px;
                align-self: stretch;
            }
            
            .main-content {
                flex-direction: column;
            }
            
            .questions-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .result-stats, .section-details {
                grid-template-columns: 1fr;
            }
            
            .controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .navigation-buttons {
                justify-content: space-between;
            }
            
            .result-buttons, .explanation-buttons {
                flex-direction: column;
            }
            
            .question-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .participant-details {
                grid-template-columns: 1fr;
            }
            
            .score-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <!-- Halaman Awal (Input Data Peserta) -->
    <div id="startScreen">
        <div class="container">
            <div class="start-container">
                <h1 class="start-title">TRYOUT TES POTENSI AKADEMIK (TPA)</h1>
                <p style="text-align: center; color: #64748b; margin-bottom: 30px;">Paket 3 | Waktu: 120 Menit | Jumlah Soal: 80</p>
                
                <div class="form-group">
                    <label for="participantName">Nama Peserta</label>
                    <input type="text" id="participantName" class="form-control" placeholder="Masukkan nama lengkap Anda">
                </div>
                
                <div class="form-group">
                    <label for="participantClass">Kelas / Jurusan</label>
                    <input type="text" id="participantClass" class="form-control" placeholder="Contoh: XII IPA 1 / Mahasiswa Semester 4">
                </div>
                
                <div class="info-box">
                    <p><strong>Perhatian:</strong> Data yang dimasukkan akan tercantum pada sertifikat hasil tryout. Pastikan data yang dimasukkan benar.</p>
                </div>
                
                <div class="start-instructions">
                    <h3>Petunjuk Pengerjaan:</h3>
                    <ul>
                        <li>Waktu pengerjaan: 120 menit untuk 80 soal</li>
                        <li>Soal terdiri dari 4 bagian: Kemampuan Verbal, Penarikan Kesimpulan, Kemampuan Numerik, dan Logika Analitik</li>
                        <li>Setiap soal memiliki bobot nilai yang berbeda:
                            <ul>
                                <li>Bagian I (Kemampuan Verbal): 1 poin per soal</li>
                                <li>Bagian II (Penarikan Kesimpulan): 1 poin per soal</li>
                                <li>Bagian III (Kemampuan Numerik): 2 poin per soal</li>
                                <li>Bagian IV (Logika Analitik): 1 poin per soal</li>
                            </ul>
                        </li>
                        <li>Gunakan navigasi soal untuk berpindah antar soal</li>
                        <li>Gunakan fitur "Tandai" untuk menandai soal yang ingin dikaji ulang</li>
                        <li>Pastikan semua soal terjawab sebelum waktu habis</li>
                    </ul>
                </div>
                
                <button class="btn btn-primary" id="startBtn" style="width: 100%; margin-top: 30px; padding: 15px;">
                    Mulai Tryout TPA
                </button>
            </div>
        </div>
    </div>
    
    <!-- Halaman Ujian (Awalnya Tersembunyi) -->
    <div id="examScreen" style="display: none;">
        <div class="container">
            <header>
                <div class="header-content">
                    <div>
                        <h1>TRYOUT TES POTENSI AKADEMIK (TPA)</h1>
                        <p>Paket 3 | Waktu: 120 Menit | Jumlah Soal: 80</p>
                        <p id="participantInfoHeader" style="font-size: 14px; opacity: 0.9; margin-top: 5px;"></p>
                    </div>
                    <div class="timer-container">
                        <div class="timer-label">SISA WAKTU</div>
                        <div id="timer">120:00</div>
                    </div>
                </div>
            </header>
            
            <div class="main-content">
                <div class="sidebar">
                    <h3>Navigasi Soal</h3>
                    <div class="questions-grid" id="questionsGrid">
                        <!-- Soal numbers will be generated by JavaScript -->
                    </div>
                    
                    <div class="exam-info">
                        <h3>Keterangan:</h3>
                        <div class="info-item">
                            <div class="info-color" style="background-color: #f1f5f9;"></div>
                            <span>Belum dijawab</span>
                        </div>
                        <div class="info-item">
                            <div class="info-color" style="background-color: #10b981;"></div>
                            <span>Sudah dijawab</span>
                        </div>
                        <div class="info-item">
                            <div class="info-color" style="background-color: #f59e0b;"></div>
                            <span>Ditandai untuk review</span>
                        </div>
                        <div class="info-item">
                            <div class="info-color" style="background-color: #3b82f6;"></div>
                            <span>Soal aktif</span>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" id="submitBtn" style="width: 100%; margin-top: 20px;">
                        Selesaikan Ujian
                    </button>
                </div>
                
                <div class="question-container">
                    <h2 class="section-title" id="sectionTitle">BAGIAN I: KEMAMPUAN VERBAL</h2>
                    <div class="question-text" id="questionText">
                        <!-- Question text will be loaded here -->
                    </div>
                    
                    <div class="options" id="optionsContainer">
                        <!-- Options will be loaded here -->
                    </div>
                    
                    <div class="controls">
                        <div class="navigation-buttons">
                            <button class="btn btn-secondary" id="prevBtn">Sebelumnya</button>
                            <button class="btn btn-secondary" id="nextBtn">Selanjutnya</button>
                            <button class="btn btn-mark" id="markBtn">Tandai</button>
                        </div>
                        <div>
                            <button class="btn btn-primary" id="clearBtn">Hapus Jawaban</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal Konfirmasi Submit -->
        <div class="modal" id="confirmModal">
            <div class="modal-content">
                <h2>Konfirmasi</h2>
                <p>Apakah Anda yakin ingin menyelesaikan ujian? Pastikan Anda telah memeriksa semua jawaban.</p>
                <div class="modal-buttons">
                    <button class="btn btn-secondary" id="cancelBtn">Batal</button>
                    <button class="btn btn-danger" id="confirmSubmitBtn">Ya, Selesaikan</button>
                </div>
            </div>
        </div>
        
        <!-- Modal Waktu Habis -->
        <div class="modal" id="timeUpModal">
            <div class="modal-content">
                <h2>Waktu Telah Habis!</h2>
                <p>Waktu pengerjaan tryout TPA telah habis. Jawaban Anda akan otomatis disubmit.</p>
                <div class="modal-buttons">
                    <button class="btn btn-primary" id="viewResultBtn">Lihat Hasil</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Hasil Ujian (Awalnya Tersembunyi) -->
    <div id="resultSection" style="display: none;">
        <div class="result-container">
            <h2 class="result-title">HASIL TRYOUT TPA PAKET 3</h2>
            
            <div class="participant-info">
                <h3>Data Peserta</h3>
                <div class="participant-details">
                    <div class="participant-detail">
                        <label>Nama</label>
                        <span id="resultName">-</span>
                    </div>
                    <div class="participant-detail">
                        <label>Kelas/Jurusan</label>
                        <span id="resultClass">-</span>
                    </div>
                </div>
            </div>
            
            <div class="result-stats">
                <div class="stat-box">
                    <div class="stat-value" id="totalScore">0</div>
                    <div class="stat-label">Skor Total</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="correctAnswers">0</div>
                    <div class="stat-label">Jawaban Benar</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="wrongAnswers">0</div>
                    <div class="stat-label">Jawaban Salah</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="skippedQuestions">0</div>
                    <div class="stat-label">Tidak Dijawab</div>
                </div>
            </div>
            
            <div class="score-breakdown">
                <h3>Rincian Nilai Per Bagian</h3>
                <table class="score-table">
                    <thead>
                        <tr>
                            <th>Bagian Ujian</th>
                            <th>Jumlah Soal</th>
                            <th>Bobot per Soal</th>
                            <th>Benar</th>
                            <th>Nilai</th>
                            <th>Maksimal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Kemampuan Verbal</td>
                            <td>40</td>
                            <td>1 poin</td>
                            <td id="verbalCorrect">0</td>
                            <td id="verbalScore">0</td>
                            <td>40</td>
                        </tr>
                        <tr>
                            <td>Penarikan Kesimpulan</td>
                            <td>10</td>
                            <td>1 poin</td>
                            <td id="conclusionCorrect">0</td>
                            <td id="conclusionScore">0</td>
                            <td>10</td>
                        </tr>
                        <tr>
                            <td>Kemampuan Numerik</td>
                            <td>20</td>
                            <td>2 poin</td>
                            <td id="numericCorrect">0</td>
                            <td id="numericScore">0</td>
                            <td>40</td>
                        </tr>
                        <tr>
                            <td>Logika Analitik</td>
                            <td>10</td>
                            <td>1 poin</td>
                            <td id="logicCorrect">0</td>
                            <td id="logicScore">0</td>
                            <td>10</td>
                        </tr>
                        <tr class="total-row">
                            <td><strong>TOTAL</strong></td>
                            <td><strong>80</strong></td>
                            <td><strong>-</strong></td>
                            <td id="totalCorrect">0</td>
                            <td id="totalScoreValue">0</td>
                            <td><strong>100</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="result-buttons">
                <button class="btn btn-primary" id="restartBtn">Mulai Tryout Lagi</button>
                <button class="btn btn-explanation" id="showExplanationsBtn">Lihat Pembahasan</button>
            </div>
        </div>
    </div>
    
    <!-- Halaman Pembahasan (Awalnya Tersembunyi) -->
    <div id="explanationsSection" style="display: none;">
        <div class="explanation-container">
            <h2 class="explanation-title">PEMBAHASAN SOAL TPA PAKET 3</h2>
            
            <div class="participant-info">
                <h3>Data Peserta</h3>
                <div class="participant-details">
                    <div class="participant-detail">
                        <label>Nama</label>
                        <span id="explanationName">-</span>
                    </div>
                    <div class="participant-detail">
                        <label>Kelas/Jurusan</label>
                        <span id="explanationClass">-</span>
                    </div>
                </div>
            </div>
            
            <div id="explanationsContent">
                <!-- Pembahasan soal akan dimuat di sini -->
            </div>
            
            <div class="explanation-buttons">
                <button class="btn btn-secondary" id="backToResultsBtn">Kembali ke Hasil</button>
                <button class="btn btn-primary" id="restartFromExplanationBtn">Mulai Tryout Lagi</button>
            </div>
        </div>
    </div>
    
    <script>
        // Data soal TPA dengan bacaan lengkap (sama seperti sebelumnya)
        const originalTpaQuestions = [
            // Bagian I: KEMAMPUAN VERBAL (40 soal)
            // Soal 1-20: Sinonim & Antonim
            {
                id: 1,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari PRAGMATIS:",
                options: ["a. Praktis", "b. Teoritis", "c. Idealistis", "d. Impraktis", "e. Filosofis"],
                correctAnswer: 0,
                explanation: "Pragmatis berarti bersifat praktis, mengutamakan kegunaan. Jadi sinonim yang tepat adalah praktis. Teoritis dan filosofis adalah lawan dari pragmatis karena lebih mengutamakan teori daripada praktik."
            },
            {
                id: 2,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari SIMPATIK:",
                options: ["a. Menarik", "b. Menyenangkan", "c. Antipati", "d. Ramah", "e. Bersahabat"],
                correctAnswer: 2,
                explanation: "Simpatik berarti menimbulkan rasa simpati, suka, atau tertarik. Antonimnya adalah antipati yang berarti rasa tidak suka atau ketidaksenangan. Menarik, menyenangkan, ramah, dan bersahabat adalah sinonim dari simpatik."
            },
            {
                id: 3,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari KONVENSI:",
                options: ["a. Perjanjian", "b. Kebiasaan", "c. Pertemuan", "d. Aturan", "e. a, b, dan d"],
                correctAnswer: 4,
                explanation: "Konvensi memiliki beberapa arti: (1) perjanjian atau kesepakatan, (2) kebiasaan yang berlaku dalam masyarakat, (3) aturan atau norma yang diterima umum. Pertemuan bukan sinonim utama dari konvensi."
            },
            {
                id: 4,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari KONVENSIONAL:",
                options: ["a. Tradisional", "b. Modern", "c. Biasa", "d. Tidak lazim", "e. b dan d"],
                correctAnswer: 4,
                explanation: "Konvensional berarti tradisional, biasa, atau sesuai dengan kebiasaan umum. Antonimnya adalah modern (mengikuti perkembangan baru) dan tidak lazim (tidak biasa atau tidak sesuai kebiasaan umum)."
            },
            {
                id: 5,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari AKOMODASI:",
                options: ["a. Penyesuaian", "b. Penginapan", "c. Fasilitas", "d. Kompromi", "e. a, b, dan c"],
                correctAnswer: 4,
                explanation: "Akomodasi memiliki beberapa arti: (1) penyesuaian diri dalam konflik sosial, (2) penginapan atau tempat tinggal, (3) fasilitas atau kemudahan. Kompromi memiliki makna yang agak berbeda yaitu kesepakatan dengan saling mengurangi tuntutan."
            },
            {
                id: 6,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari EKSPRESIF:",
                options: ["a. Ekspresif", "b. Eksplisit", "c. Impresif", "d. Tidak ekspresif", "e. Pasif"],
                correctAnswer: 3,
                explanation: "Ekspresif berarti mampu mengungkapkan perasaan atau pikiran dengan baik. Antonim langsungnya adalah 'tidak ekspresif'. Pasif mungkin bisa dianggap antonim tidak langsung, tetapi 'tidak ekspresif' lebih tepat sebagai antonim langsung."
            },
            {
                id: 7,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari RELEVAN:",
                options: ["a. Penting", "b. Berhubungan", "c. Sesuai", "d. Tepat", "e. Semua benar"],
                correctAnswer: 4,
                explanation: "Relevan berarti mempunyai kaitan dengan hal yang sedang dibahas; bersangkut paut; penting dan sesuai dengan kebutuhan. Semua pilihan (penting, berhubungan, sesuai, tepat) adalah sinonim dari relevan dalam konteks yang berbeda-beda."
            },
            {
                id: 8,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari KOMPETITIF:",
                options: ["a. Bersaing", "b. Kooperatif", "c. Kompeten", "d. Tidak bersaing", "e. b dan d"],
                correctAnswer: 4,
                explanation: "Kompetitif berarti bersifat bersaing. Antonimnya adalah kooperatif (bekerja sama) dan tidak bersaing. Kompeten berarti cakap atau mampu, bukan antonim dari kompetitif."
            },
            {
                id: 9,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari INTEGRAL:",
                options: ["a. Terpisah", "b. Menyeluruh", "c. Penting", "d. Utuh", "e. b, c, dan d"],
                correctAnswer: 4,
                explanation: "Integral berarti merupakan bagian yang tidak terpisahkan; utuh; lengkap; penting dan diperlukan untuk kelengkapan. Terpisah adalah antonim, bukan sinonim."
            },
            {
                id: 10,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari KONSENSUS:",
                options: ["a. Kesepakatan", "b. Persetujuan", "c. Perbedaan pendapat", "d. Konflik", "e. c dan d"],
                correctAnswer: 4,
                explanation: "Konsensus berarti kesepakatan atau persetujuan umum. Antonimnya adalah perbedaan pendapat dan konflik (pertentangan)."
            },
            {
                id: 11,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari ADAPTASI:",
                options: ["a. Penyesuaian", "b. Perubahan", "c. Evolusi", "d. Modifikasi", "e. Semua benar"],
                correctAnswer: 4,
                explanation: "Adaptasi berarti penyesuaian diri dengan lingkungan. Semua pilihan (penyesuaian, perubahan, evolusi, modifikasi) adalah sinonim atau berkaitan erat dengan adaptasi dalam konteks yang berbeda."
            },
            {
                id: 12,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari STAGNAN:",
                options: ["a. Statis", "b. Dinamis", "c. Diam", "d. Bergerak", "e. b dan d"],
                correctAnswer: 4,
                explanation: "Stagnan berarti tidak bergerak; statis; diam. Antonimnya adalah dinamis (penuh semangat dan tenaga sehingga cepat bergerak) dan bergerak."
            },
            {
                id: 13,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari KOMPLEKS:",
                options: ["a. Rumit", "b. Sederhana", "c. Pelik", "d. Majemuk", "e. a, c, dan d"],
                correctAnswer: 4,
                explanation: "Kompleks berarti terdiri atas banyak bagian yang sulit dipahami; rumit; pelik; majemuk. Sederhana adalah antonim, bukan sinonim."
            },
            {
                id: 14,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari AKURAT:",
                options: ["a. Tepat", "b. Salah", "c. Tidak akurat", "d. Melenceng", "e. b, c, dan d"],
                correctAnswer: 4,
                explanation: "Akurat berarti tepat; teliti; saksama. Antonimnya adalah salah, tidak akurat, dan melenceng (tidak tepat sasaran). Tepat adalah sinonim, bukan antonim."
            },
            {
                id: 15,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari EFISIENSI:",
                options: ["a. Daya guna", "b. Hemat", "c. Produktivitas", "d. Keefektifan", "e. Semua benar"],
                correctAnswer: 4,
                explanation: "Efisiensi berarti ketepatan cara (usaha, kerja) dalam menjalankan sesuatu dengan tidak membuang waktu, tenaga, biaya; kemampuan menjalankan tugas dengan baik dan tepat dengan sedikit mungkin membuang waktu dan tenaga. Semua pilihan adalah sinonim atau berkaitan erat dengan efisiensi."
            },
            {
                id: 16,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari FLEKSIBEL:",
                options: ["a. Lentur", "b. Kaku", "c. Luwes", "d. Tidak fleksibel", "e. b dan d"],
                correctAnswer: 4,
                explanation: "Fleksibel berarti lentur; mudah menyesuaikan diri; luwes. Antonimnya adalah kaku dan tidak fleksibel. Lentur dan luwes adalah sinonim, bukan antonim."
            },
            {
                id: 17,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari KAPABEL:",
                options: ["a. Mampu", "b. Cakap", "c. Kompeten", "d. Tidak mampu", "e. a, b, dan c"],
                correctAnswer: 4,
                explanation: "Kapabel berarti mampu; cakap; kompeten. Tidak mampu adalah antonim, bukan sinonim."
            },
            {
                id: 18,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari AMBIGU:",
                options: ["a. Jelas", "b. Tidak ambigu", "c. Bermakna ganda", "d. Tegas", "e. a, b, dan d"],
                correctAnswer: 4,
                explanation: "Ambiguitas berarti mempunyai lebih dari satu makna; bermakna ganda; tidak jelas. Antonimnya adalah jelas, tidak ambigu, dan tegas (pasti dan jelas). Bermakna ganda adalah sinonim, bukan antonim."
            },
            {
                id: 19,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Sinonim dari INOVASI:",
                options: ["a. Pembaruan", "b. Penemuan", "c. Terobosan", "d. Tradisi", "e. a, b, dan c"],
                correctAnswer: 4,
                explanation: "Inovasi berarti pemasukan atau pengenalan hal-hal baru; pembaruan; penemuan baru; terobosan. Tradisi adalah kebalikan dari inovasi karena berkaitan dengan hal-hal lama yang dipertahankan."
            },
            {
                id: 20,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Sinonim & Antonim",
                question: "Antonim dari SEKULER:",
                options: ["a. Duniawi", "b. Agamis", "c. Spiritual", "d. Rohani", "e. b, c, dan d"],
                correctAnswer: 4,
                explanation: "Sekuler berarti bersifat keduniawian; tidak bersifat keagamaan. Antonimnya adalah agamis, spiritual, dan rohani yang semuanya berkaitan dengan keagamaan. Duniawi adalah sinonim, bukan antonim."
            },
            // Soal 21-30: Analogi Verbal
            {
                id: 21,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "OMBAK : LAUT = ANGIN : _____",
                options: ["a. Darat", "b. Udara", "c. Langit", "d. Pepohonan", "e. Awan"],
                correctAnswer: 1,
                explanation: "Ombak terjadi di laut, maka angin terjadi di udara. Hubungannya adalah fenomena alam dan tempat terjadinya."
            },
            {
                id: 22,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "DOKTER : STETOSKOP = TUKANG KAYU : _____",
                options: ["a. Palu", "b. Gergaji", "c. Obat", "d. Pasien", "e. Alat"],
                correctAnswer: 1,
                explanation: "Stetoskop adalah alat khusus dokter, maka gergaji adalah alat khusus tukang kayu. Palu juga alat tukang kayu, tetapi gergaji lebih spesifik untuk tukang kayu."
            },
            {
                id: 23,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "PUISI : SAJAK = PROSA : _____",
                options: ["a. Bait", "b. Paragraf", "c. Kata", "d. Kalimat", "e. Cerita"],
                correctAnswer: 1,
                explanation: "Sajak adalah bagian dari puisi, maka paragraf adalah bagian dari prosa. Bait adalah bagian dari puisi, bukan prosa."
            },
            {
                id: 24,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "MATAHARI : ENERGI = TANAMAN : _____",
                options: ["a. Makanan", "b. Fotosintesis", "c. Oksigen", "d. Air", "e. Tanah"],
                correctAnswer: 1,
                explanation: "Matahari menghasilkan energi, maka tanaman melakukan fotosintesis. Fotosintesis adalah proses utama tanaman, seperti energi adalah produk utama matahari."
            },
            {
                id: 25,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "BACA : PENGERTIAN = DENGAR : _____",
                options: ["a. Pendengaran", "b. Suara", "c. Pemahaman", "d. Telinga", "e. Audio"],
                correctAnswer: 2,
                explanation: "Membaca menghasilkan pengertian, maka mendengar menghasilkan pemahaman. Hubungannya adalah aktivitas indera dan hasil kognitifnya."
            },
            {
                id: 26,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "KAKI : SEPATU = TANGAN : _____",
                options: ["a. Sarung tangan", "b. Cincin", "c. Jam tangan", "d. Gelang", "e. Semua benar"],
                correctAnswer: 0,
                explanation: "Sepatu adalah pelindung kaki, maka sarung tangan adalah pelindung tangan. Cincin, jam tangan, dan gelang adalah perhiasan atau aksesori, bukan pelindung utama."
            },
            {
                id: 27,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "AIR : HAUS = TIDUR : _____",
                options: ["a. Lelah", "b. Tempat tidur", "c. Mimpi", "d. Kasur", "e. Bantal"],
                correctAnswer: 0,
                explanation: "Air menghilangkan haus, maka tidur menghilangkan lelah. Hubungannya adalah kebutuhan dan pemuas kebutuhan."
            },
            {
                id: 28,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "GURU : SEKOLAH = DOKTER : _____",
                options: ["a. Rumah sakit", "b. Pasien", "c. Obat", "d. Penyakit", "e. Operasi"],
                correctAnswer: 0,
                explanation: "Guru bekerja di sekolah, maka dokter bekerja di rumah sakit. Hubungannya adalah profesi dan tempat kerja utamanya."
            },
            {
                id: 29,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "BURUNG : TERBANG = IKAN : _____",
                options: ["a. Berenang", "b. Laut", "c. Insang", "d. Sirip", "e. Air"],
                correctAnswer: 0,
                explanation: "Burung bergerak dengan terbang, maka ikan bergerak dengan berenang. Hubungannya adalah hewan dan cara bergeraknya."
            },
            {
                id: 30,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Analogi Verbal",
                question: "BUKU : PERPUSTAKAAN = UANG : _____",
                options: ["a. Bank", "b. Dompet", "c. Pasar", "d. Toko", "e. ATM"],
                correctAnswer: 0,
                explanation: "Buku disimpan di perpustakaan, maka uang disimpan di bank. Bank adalah tempat penyimpanan uang yang utama, seperti perpustakaan untuk buku."
            },
            // Soal 31-35: Pemahaman Wacana (Bacaan 1 - LENGKAP)
            {
                id: 31,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 1:</strong><br><br>
                Ekonomi kreatif merupakan salah satu sektor yang mengalami pertumbuhan pesat dalam beberapa tahun terakhir. Sektor ini mencakup berbagai bidang seperti desain, periklanan, film, musik, dan aplikasi digital. Keunggulan ekonomi kreatif terletak pada pemanfaatan kreativitas dan intelektualitas sebagai modal utama, sehingga tidak terlalu bergantung pada sumber daya alam. Pemerintah Indonesia telah menetapkan ekonomi kreatif sebagai salah satu prioritas pembangunan karena potensinya dalam menciptakan lapangan kerja dan meningkatkan daya saing bangsa di era global.<br><br>
                <strong>Pertanyaan:</strong> Apa fokus utama ekonomi kreatif?`,
                options: [
                    "a. Pemanfaatan sumber daya alam",
                    "b. Penggunaan kreativitas dan intelektualitas",
                    "c. Eksploitasi tenaga kerja murah",
                    "d. Investasi modal besar",
                    "e. Ekspor bahan mentah"
                ],
                correctAnswer: 1,
                explanation: "Bacaan dengan jelas menyatakan: 'Keunggulan ekonomi kreatif terletak pada pemanfaatan kreativitas dan intelektualitas sebagai modal utama'. Ini menunjukkan fokus utama ekonomi kreatif adalah penggunaan kreativitas dan intelektualitas, bukan sumber daya alam, tenaga kerja murah, modal besar, atau ekspor bahan mentah."
            },
            {
                id: 32,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 1:</strong><br><br>
                Ekonomi kreatif merupakan salah satu sektor yang mengalami pertumbuhan pesat dalam beberapa tahun terakhir. Sektor ini mencakup berbagai bidang seperti desain, periklanan, film, musik, dan aplikasi digital. Keunggulan ekonomi kreatif terletak pada pemanfaatan kreativitas dan intelektualitas sebagai modal utama, sehingga tidak terlalu bergantung pada sumber daya alam. Pemerintah Indonesia telah menetapkan ekonomi kreatif sebagai salah satu prioritas pembangunan karena potensinya dalam menciptakan lapangan kerja dan meningkatkan daya saing bangsa di era global.<br><br>
                <strong>Pertanyaan:</strong> Contoh bidang ekonomi kreatif yang disebutkan adalah:`,
                options: [
                    "a. Desain dan periklanan",
                    "b. Film dan musik",
                    "c. Aplikasi digital",
                    "d. Semua benar",
                    "e. Hanya a dan b"
                ],
                correctAnswer: 3,
                explanation: "Bacaan menyebutkan: 'Sektor ini mencakup berbagai bidang seperti desain, periklanan, film, musik, dan aplikasi digital.' Semua pilihan (desain, periklanan, film, musik, aplikasi digital) disebutkan dalam bacaan, sehingga jawaban yang tepat adalah 'Semua benar'."
            },
            {
                id: 33,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 1:</strong><br><br>
                Ekonomi kreatif merupakan salah satu sektor yang mengalami pertumbuhan pesat dalam beberapa tahun terakhir. Sektor ini mencakup berbagai bidang seperti desain, periklanan, film, musik, dan aplikasi digital. Keunggulan ekonomi kreatif terletak pada pemanfaatan kreativitas dan intelektualitas sebagai modal utama, sehingga tidak terlalu bergantung pada sumber daya alam. Pemerintah Indonesia telah menetapkan ekonomi kreatif sebagai salah satu prioritas pembangunan karena potensinya dalam menciptakan lapangan kerja dan meningkatkan daya saing bangsa di era global.<br><br>
                <strong>Pertanyaan:</strong> Keunggulan ekonomi kreatif adalah:`,
                options: [
                    "a. Tidak terlalu bergantung pada sumber daya alam",
                    "b. Memanfaatkan kreativitas sebagai modal",
                    "c. Menciptakan lapangan kerja",
                    "d. Semua benar",
                    "e. Hanya a dan b"
                ],
                correctAnswer: 3,
                explanation: "Bacaan menyebutkan tiga keunggulan ekonomi kreatif: (1) 'tidak terlalu bergantung pada sumber daya alam', (2) 'memanfaatkan kreativitas dan intelektualitas sebagai modal', dan (3) 'potensinya dalam menciptakan lapangan kerja'. Jadi semua pernyataan benar."
            },
            {
                id: 34,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 1:</strong><br><br>
                Ekonomi kreatif merupakan salah satu sektor yang mengalami pertumbuhan pesat dalam beberapa tahun terakhir. Sektor ini mencakup berbagai bidang seperti desain, periklanan, film, musik, dan aplikasi digital. Keunggulan ekonomi kreatif terletak pada pemanfaatan kreativitas dan intelektualitas sebagai modal utama, sehingga tidak terlalu bergantung pada sumber daya alam. Pemerintah Indonesia telah menetapkan ekonomi kreatif sebagai salah satu prioritas pembangunan karena potensinya dalam menciptakan lapangan kerja dan meningkatkan daya saing bangsa di era global.<br><br>
                <strong>Pertanyaan:</strong> Mengapa pemerintah memprioritaskan ekonomi kreatif?`,
                options: [
                    "a. Potensi menciptakan lapangan kerja",
                    "b. Meningkatkan daya saing bangsa",
                    "c. Tidak memerlukan modal besar",
                    "d. a dan b",
                    "e. Semua benar"
                ],
                correctAnswer: 3,
                explanation: "Bacaan menyatakan: 'Pemerintah Indonesia telah menetapkan ekonomi kreatif sebagai salah satu prioritas pembangunan karena potensinya dalam menciptakan lapangan kerja dan meningkatkan daya saing bangsa di era global.' Hanya alasan a dan b yang disebutkan dalam bacaan. Tidak ada pernyataan bahwa ekonomi kreatif tidak memerlukan modal besar."
            },
            {
                id: 35,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 1:</strong><br><br>
                Ekonomi kreatif merupakan salah satu sektor yang mengalami pertumbuhan pesat dalam beberapa tahun terakhir. Sektor ini mencakup berbagai bidang seperti desain, periklanan, film, musik, dan aplikasi digital. Keunggulan ekonomi kreatif terletak pada pemanfaatan kreativitas dan intelektualitas sebagai modal utama, sehingga tidak terlalu bergantung pada sumber daya alam. Pemerintah Indonesia telah menetapkan ekonomi kreatif sebagai salah satu prioritas pembangunan karena potensinya dalam menciptakan lapangan kerja dan meningkatkan daya saing bangsa di era global.<br><br>
                <strong>Pertanyaan:</strong> Ekonomi kreatif penting di era global karena:`,
                options: [
                    "a. Dapat bersaing dengan produk luar negeri",
                    "b. Mengandalkan sumber daya alam lokal",
                    "c. Membutuhkan tenaga kerja dalam jumlah besar",
                    "d. Tidak memerlukan keterampilan khusus",
                    "e. Dapat dikembangkan di pedesaan"
                ],
                correctAnswer: 0,
                explanation: "Meskipun tidak secara eksplisit dinyatakan, bacaan mengimplikasikan bahwa ekonomi kreatif penting untuk 'meningkatkan daya saing bangsa di era global'. Ini berarti ekonomi kreatif dapat membantu Indonesia bersaing dengan produk luar negeri. Pilihan lain tidak didukung oleh bacaan."
            },
            // Soal 36-40: Pemahaman Wacana (Bacaan 2 - LENGKAP)
            {
                id: 36,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 2:</strong><br><br>
                Pendidikan karakter menjadi sorotan dalam sistem pendidikan Indonesia belakangan ini. Pendidikan karakter tidak hanya berfokus pada aspek kognitif, tetapi juga pada pembentukan nilai-nilai moral, etika, dan sikap. Tujuannya adalah menciptakan generasi yang tidak hanya cerdas secara akademik, tetapi juga memiliki integritas, tanggung jawab, dan kepedulian sosial. Implementasi pendidikan karakter dilakukan melalui integrasi dalam mata pelajaran, kegiatan ekstrakurikuler, dan budaya sekolah. Tantangan yang dihadapi adalah bagaimana mengukur keberhasilan pendidikan karakter secara objektif.<br><br>
                <strong>Pertanyaan:</strong> Apa yang menjadi fokus pendidikan karakter?`,
                options: [
                    "a. Aspek kognitif saja",
                    "b. Nilai-nilai moral dan etika",
                    "c. Keterampilan teknis",
                    "d. Penguasaan bahasa asing",
                    "e. Kemampuan matematika"
                ],
                correctAnswer: 1,
                explanation: "Bacaan dengan jelas menyatakan: 'Pendidikan karakter tidak hanya berfokus pada aspek kognitif, tetapi juga pada pembentukan nilai-nilai moral, etika, dan sikap.' Jadi fokus pendidikan karakter adalah nilai-nilai moral dan etika, bukan hanya aspek kognitif atau keterampilan teknis."
            },
            {
                id: 37,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 2:</strong><br><br>
                Pendidikan karakter menjadi sorotan dalam sistem pendidikan Indonesia belakangan ini. Pendidikan karakter tidak hanya berfokus pada aspek kognitif, tetapi juga pada pembentukan nilai-nilai moral, etika, dan sikap. Tujuannya adalah menciptakan generasi yang tidak hanya cerdas secara akademik, tetapi juga memiliki integritas, tanggung jawab, dan kepedulian sosial. Implementasi pendidikan karakter dilakukan melalui integrasi dalam mata pelajaran, kegiatan ekstrakurikuler, dan budaya sekolah. Tantangan yang dihadapi adalah bagaimana mengukur keberhasilan pendidikan karakter secara objektif.<br><br>
                <strong>Pertanyaan:</strong> Tujuan pendidikan karakter adalah:`,
                options: [
                    "a. Menciptakan generasi cerdas akademik",
                    "b. Membentuk generasi berintegritas dan bertanggung jawab",
                    "c. Meningkatkan kepedulian sosial",
                    "d. Semua benar",
                    "e. Hanya b dan c"
                ],
                correctAnswer: 3,
                explanation: "Bacaan menyebutkan: 'Tujuannya adalah menciptakan generasi yang tidak hanya cerdas secara akademik, tetapi juga memiliki integritas, tanggung jawab, dan kepedulian sosial.' Ini mencakup semua pilihan: cerdas akademik (a), berintegritas dan bertanggung jawab (b), dan kepedulian sosial (c)."
            },
            {
                id: 38,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 2:</strong><br><br>
                Pendidikan karakter menjadi sorotan dalam sistem pendidikan Indonesia belakangan ini. Pendidikan karakter tidak hanya berfokus pada aspek kognitif, tetapi juga pada pembentukan nilai-nilai moral, etika, dan sikap. Tujuannya adalah menciptakan generasi yang tidak hanya cerdas secara akademik, tetapi juga memiliki integritas, tanggung jawab, dan kepedulian sosial. Implementasi pendidikan karakter dilakukan melalui integrasi dalam mata pelajaran, kegiatan ekstrakurikuler, dan budaya sekolah. Tantangan yang dihadapi adalah bagaimana mengukur keberhasilan pendidikan karakter secara objektif.<br><br>
                <strong>Pertanyaan:</strong> Cara implementasi pendidikan karakter adalah:`,
                options: [
                    "a. Integrasi dalam mata pelajaran",
                    "b. Kegiatan ekstrakurikuler",
                    "c. Budaya sekolah",
                    "d. Semua benar",
                    "e. Hanya a dan b"
                ],
                correctAnswer: 3,
                explanation: "Bacaan menyatakan: 'Implementasi pendidikan karakter dilakukan melalui integrasi dalam mata pelajaran, kegiatan ekstrakurikuler, dan budaya sekolah.' Jadi semua cara implementasi (a, b, dan c) disebutkan dalam bacaan."
            },
            {
                id: 39,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 2:</strong><br><br>
                Pendidikan karakter menjadi sorotan dalam sistem pendidikan Indonesia belakangan ini. Pendidikan karakter tidak hanya berfokus pada aspek kognitif, tetapi juga pada pembentukan nilai-nilai moral, etika, dan sikap. Tujuannya adalah menciptakan generasi yang tidak hanya cerdas secara akademik, tetapi juga memiliki integritas, tanggung jawab, dan kepedulian sosial. Implementasi pendidikan karakter dilakukan melalui integrasi dalam mata pelajaran, kegiatan ekstrakurikuler, dan budaya sekolah. Tantangan yang dihadapi adalah bagaimana mengukur keberhasilan pendidikan karakter secara objektif.<br><br>
                <strong>Pertanyaan:</strong> Tantangan pendidikan karakter adalah:`,
                options: [
                    "a. Kurangnya tenaga pengajar",
                    "b. Kesulitan mengukur keberhasilan secara objektif",
                    "c. Tidak ada kurikulum yang jelas",
                    "d. Minat siswa yang rendah",
                    "e. Tidak didukung orang tua"
                ],
                correctAnswer: 1,
                explanation: "Bacaan secara eksplisit menyatakan: 'Tantangan yang dihadapi adalah bagaimana mengukur keberhasilan pendidikan karakter secara objektif.' Tidak ada pernyataan tentang kurangnya tenaga pengajar, kurikulum, minat siswa, atau dukungan orang tua sebagai tantangan."
            },
            {
                id: 40,
                section: "BAGIAN I: KEMAMPUAN VERBAL",
                type: "Pemahaman Wacana",
                question: `<strong>Bacaan 2:</strong><br><br>
                Pendidikan karakter menjadi sorotan dalam sistem pendidikan Indonesia belakangan ini. Pendidikan karakter tidak hanya berfokus pada aspek kognitif, tetapi juga pada pembentukan nilai-nilai moral, etika, dan sikap. Tujuannya adalah menciptakan generasi yang tidak hanya cerdas secara akademik, tetapi juga memiliki integritas, tanggung jawab, dan kepedulian sosial. Implementasi pendidikan karakter dilakukan melalui integrasi dalam mata pelajaran, kegiatan ekstrakurikuler, dan budaya sekolah. Tantangan yang dihadapi adalah bagaimana mengukur keberhasilan pendidikan karakter secara objektif.<br><br>
                <strong>Pertanyaan:</strong> Menurut paragraf, pendidikan karakter penting karena:`,
                options: [
                    "a. Melengkapi kecerdasan akademik dengan moral",
                    "b. Meningkatkan ranking sekolah",
                    "c. Mempermudah ujian nasional",
                    "d. Menambah jam pelajaran",
                    "e. Mengurangi biaya pendidikan"
                ],
                correctAnswer: 0,
                explanation: "Bacaan menjelaskan bahwa pendidikan karakter bertujuan menciptakan generasi yang 'tidak hanya cerdas secara akademik, tetapi juga memiliki integritas, tanggung jawab, dan kepedulian sosial.' Ini berarti pendidikan karakter melengkapi kecerdasan akademik dengan moral. Pilihan lain tidak disebutkan dalam bacaan."
            },
            // BAGIAN II: PENARIKAN KESIMPULAN (10 soal) - Soal 41-50
            {
                id: 41,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Semua pegawai negeri mendapatkan gaji dari pemerintah. Beberapa guru adalah pegawai negeri.<br><br>Kesimpulan:",
                options: [
                    "a. Semua guru mendapatkan gaji dari pemerintah",
                    "b. Beberapa guru mendapatkan gaji dari pemerintah",
                    "c. Semua pegawai negeri adalah guru",
                    "d. Tidak ada guru yang mendapatkan gaji dari pemerintah",
                    "e. Tidak dapat ditarik kesimpulan"
                ],
                correctAnswer: 1,
                explanation: "Premis 1: Semua PNS digaji pemerintah. Premis 2: Beberapa guru adalah PNS. Kesimpulan: Beberapa guru digaji pemerintah. Tidak semua guru digaji pemerintah karena hanya beberapa yang PNS. Tidak semua PNS adalah guru."
            },
            {
                id: 42,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Jika ada asap, maka ada api. Tidak ada asap.<br><br>Kesimpulan:",
                options: [
                    "a. Ada api",
                    "b. Tidak ada api",
                    "c. Mungkin ada api",
                    "d. Api padam",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 2,
                explanation: "Ini adalah contoh logika implikasi. 'Jika P maka Q' dan 'tidak P' tidak memberikan kesimpulan pasti tentang Q. Bisa ada api tanpa asap (api biru, api kecil) atau tidak ada api. Jadi kita hanya bisa mengatakan 'mungkin ada api'."
            },
            {
                id: 43,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Semua hewan bernafas. Tumbuhan bukan hewan.<br><br>Kesimpulan:",
                options: [
                    "a. Tumbuhan bernafas",
                    "b. Tumbuhan tidak bernafas",
                    "c. Tumbuhan mungkin bernafas",
                    "d. Hanya hewan yang bernafas",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 4,
                explanation: "Premis hanya mengatakan semua hewan bernafas, dan tumbuhan bukan hewan. Tidak ada informasi apakah tumbuhan bernafas atau tidak. Jadi tidak dapat disimpulkan apakah tumbuhan bernafas atau tidak."
            },
            {
                id: 44,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Setiap peserta seminar mendapatkan sertifikat. Budi mendapatkan sertifikat.<br><br>Kesimpulan:",
                options: [
                    "a. Budi peserta seminar",
                    "b. Budi bukan peserta seminar",
                    "c. Budi mungkin peserta seminar",
                    "d. Semua orang mendapatkan sertifikat",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 2,
                explanation: "Premis: Semua peserta seminar dapat sertifikat. Budi dapat sertifikat. Bisa saja Budi dapat sertifikat dari sumber lain, bukan karena ikut seminar. Jadi kita hanya bisa mengatakan 'Budi mungkin peserta seminar', tidak pasti."
            },
            {
                id: 45,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Tidak ada manusia yang bisa hidup tanpa air. Ali adalah manusia.<br><br>Kesimpulan:",
                options: [
                    "a. Ali bisa hidup tanpa air",
                    "b. Ali tidak bisa hidup tanpa air",
                    "c. Ali mungkin bisa hidup tanpa air",
                    "d. Beberapa manusia bisa hidup tanpa air",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 1,
                explanation: "Premis: Tidak ada manusia yang bisa hidup tanpa air. Ali manusia. Kesimpulan: Ali tidak bisa hidup tanpa air. Ini adalah silogisme kategoris yang valid."
            },
            {
                id: 46,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Semua sepeda memiliki roda. Beberapa kendaraan memiliki roda.<br><br>Kesimpulan:",
                options: [
                    "a. Semua kendaraan adalah sepeda",
                    "b. Beberapa kendaraan adalah sepeda",
                    "c. Semua sepeda adalah kendaraan",
                    "d. Tidak ada hubungan antara sepeda dan kendaraan",
                    "e. Tidak dapat ditarik kesimpulan"
                ],
                correctAnswer: 4,
                explanation: "Premis 1: Semua sepeda punya roda. Premis 2: Beberapa kendaraan punya roda. Tidak ada hubungan inklusi antara sepeda dan kendaraan. Bisa saja kendaraan yang punya roda itu mobil, motor, dll. Tidak dapat disimpulkan hubungan antara sepeda dan kendaraan."
            },
            {
                id: 47,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Jika baterai habis, maka ponsel mati. Ponsel tidak mati.<br><br>Kesimpulan:",
                options: [
                    "a. Baterai habis",
                    "b. Baterai tidak habis",
                    "c. Baterai mungkin habis",
                    "d. Ada masalah lain",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 1,
                explanation: "Ini adalah modus tollens: Jika P maka Q. Tidak Q. Maka tidak P. Jika baterai habis maka ponsel mati. Ponsel tidak mati. Maka baterai tidak habis."
            },
            {
                id: 48,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Semua planet mengelilingi matahari. Bulan bukan planet.<br><br>Kesimpulan:",
                options: [
                    "a. Bulan mengelilingi matahari",
                    "b. Bulan tidak mengelilingi matahari",
                    "c. Bulan mungkin mengelilingi matahari",
                    "d. Hanya planet yang mengelilingi matahari",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 4,
                explanation: "Premis hanya mengatakan semua planet mengelilingi matahari. Bulan bukan planet. Tidak ada informasi apakah benda selain planet mengelilingi matahari atau tidak. Jadi tidak dapat disimpulkan tentang bulan."
            },
            {
                id: 49,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Setiap atlet memiliki stamina yang baik. Rina memiliki stamina yang baik.<br><br>Kesimpulan:",
                options: [
                    "a. Rina adalah atlet",
                    "b. Rina bukan atlet",
                    "c. Rina mungkin atlet",
                    "d. Semua orang yang stamina baik adalah atlet",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 2,
                explanation: "Premis: Semua atlet stamina baik. Rina stamina baik. Bisa saja Rina bukan atlet tapi punya stamina baik. Jadi hanya bisa disimpulkan 'Rina mungkin atlet', tidak pasti."
            },
            {
                id: 50,
                section: "BAGIAN II: PENARIKAN KESIMPULAN",
                type: "Penarikan Kesimpulan",
                question: "Semua mobil memiliki mesin. Benda ini memiliki mesin.<br><br>Kesimpulan:",
                options: [
                    "a. Benda ini adalah mobil",
                    "b. Benda ini bukan mobil",
                    "c. Benda ini mungkin mobil",
                    "d. Hanya mobil yang memiliki mesin",
                    "e. Tidak dapat disimpulkan"
                ],
                correctAnswer: 2,
                explanation: "Premis: Semua mobil punya mesin. Benda ini punya mesin. Benda ini bisa mobil, motor, generator, dll. Jadi hanya bisa disimpulkan 'Benda ini mungkin mobil', tidak pasti."
            },
            // BAGIAN III: KEMAMPUAN NUMERIK (20 soal)
            // Soal 51-55: Deret Angka
            {
                id: 51,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Deret Angka",
                question: "Lanjutan deret: 1, 1, 2, 3, 5, 8, ...",
                options: ["a. 11", "b. 12", "c. 13", "d. 14", "e. 15"],
                correctAnswer: 2,
                explanation: "Ini adalah deret Fibonacci. Setiap angka adalah jumlah dua angka sebelumnya: 1+1=2, 1+2=3, 2+3=5, 3+5=8, 5+8=13. Jadi angka berikutnya adalah 13."
            },
            {
                id: 52,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Deret Angka",
                question: "Lanjutan deret: 2, 3, 5, 7, 11, 13, ...",
                options: ["a. 15", "b. 17", "c. 19", "d. 21", "e. 23"],
                correctAnswer: 1,
                explanation: "Ini adalah deret bilangan prima: 2, 3, 5, 7, 11, 13, 17. Bilangan prima berikutnya setelah 13 adalah 17."
            },
            {
                id: 53,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Deret Angka",
                question: "Lanjutan deret: 10, 20, 40, 80, 160, ...",
                options: ["a. 200", "b. 240", "c. 280", "d. 320", "e. 360"],
                correctAnswer: 3,
                explanation: "Ini adalah deret geometri dengan rasio 2: 102=20, 202=40, 402=80, 802=160, 1602=320. Jadi angka berikutnya adalah 320."
            },
            {
                id: 54,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Deret Angka",
                question: "Lanjutan deret: 1, 8, 27, 64, 125, ...",
                options: ["a. 150", "b. 180", "c. 210", "d. 216", "e. 225"],
                correctAnswer: 3,
                explanation: "Ini adalah deret pangkat tiga: 1=1, 2=8, 3=27, 4=64, 5=125, 6=216. Jadi angka berikutnya adalah 216."
            },
            {
                id: 55,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Deret Angka",
                question: "Lanjutan deret: 3, 6, 9, 12, 15, ...",
                options: ["a. 17", "b. 18", "c. 19", "d. 20", "e. 21"],
                correctAnswer: 1,
                explanation: "Ini adalah deret aritmatika dengan beda 3: 3+3=6, 6+3=9, 9+3=12, 12+3=15, 15+3=18. Jadi angka berikutnya adalah 18."
            },
            // Soal 56-65: Aritmatika Dasar & Perbandingan
            {
                id: 56,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "20% dari 250 adalah:",
                options: ["a. 25", "b. 40", "c. 50", "d. 75", "e. 100"],
                correctAnswer: 2,
                explanation: "20% dari 250 = 20/100  250 = 0.2  250 = 50. Cara cepat: 10% dari 250 adalah 25, maka 20% adalah 2  25 = 50."
            },
            {
                id: 57,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Jika a = 7 dan b = 5, maka nilai dari 3a - 2b adalah:",
                options: ["a. -29", "b. -31", "c. 29", "d. 31", "e. 33"],
                correctAnswer: 0,
                explanation: "3a - 2b = 37 - 25 = 21 - 225 = 21 - 50 = -29. Perhatikan urutan operasi: pangkat dulu (b=25), lalu perkalian (225=50), lalu pengurangan."
            },
            {
                id: 58,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Perbandingan siswa kelas X : XI : XII = 5 : 4 : 3. Jika jumlah seluruh siswa 480 orang, jumlah siswa kelas XI adalah:",
                options: ["a. 120", "b. 140", "c. 160", "d. 180", "e. 200"],
                correctAnswer: 2,
                explanation: "Total perbandingan = 5+4+3 = 12 bagian. Jumlah siswa kelas XI = 4/12  480 = 1/3  480 = 160 orang."
            },
            {
                id: 59,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Sebuah toko memberikan diskon 30% untuk semua barang. Jika harga sebuah tas setelah diskon adalah Rp210.000, harga tas sebelum diskon adalah:",
                options: ["a. Rp250.000", "b. Rp280.000", "c. Rp300.000", "d. Rp320.000", "e. Rp350.000"],
                correctAnswer: 2,
                explanation: "Harga setelah diskon 30% = 70% dari harga asli. 70%  Harga asli = 210.000. Harga asli = 210.000  0.7 = 300.000. Cara: 210.000  7 = 30.000 (ini 10%), maka 100% = 10  30.000 = 300.000."
            },
            {
                id: 60,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Jika 4 orang dapat menyelesaikan pekerjaan dalam 18 hari, berapa hari yang diperlukan 9 orang?",
                options: ["a. 6 hari", "b. 7 hari", "c. 8 hari", "d. 9 hari", "e. 10 hari"],
                correctAnswer: 2,
                explanation: "Ini soal perbandingan berbalik nilai. 4 orang  18 hari. 9 orang  x hari. 418 = 9x  72 = 9x  x = 729 = 8 hari. Semakin banyak orang, semakin sedikit hari yang dibutuhkan."
            },
            {
                id: 61,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Hasil dari 0,6  0,25  0,5 adalah:",
                options: ["a. 0,15", "b. 0,25", "c. 0,3", "d. 0,5", "e. 0,75"],
                correctAnswer: 2,
                explanation: "0,6  0,25 = 0,15. 0,15  0,5 = 0,3. Cara lain: 0,6  0,25  0,5 = 0,6  (0,250,5) = 0,6  0,5 = 0,3."
            },
            {
                id: 62,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Dalam sebuah kantor, perbandingan pegawai laki-laki dan perempuan adalah 7 : 5. Jika jumlah pegawai laki-laki 35 orang, jumlah pegawai perempuan adalah:",
                options: ["a. 20", "b. 25", "c. 30", "d. 35", "e. 40"],
                correctAnswer: 1,
                explanation: "Perbandingan L:P = 7:5. Laki-laki = 35 orang. 7 bagian = 35, maka 1 bagian = 357 = 5. Perempuan = 5 bagian = 55 = 25 orang."
            },
            {
                id: 63,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Jika x = 10, y = 4, dan z = 2, maka nilai dari (x+y)  z adalah:",
                options: ["a. 96", "b. 98", "c. 100", "d. 102", "e. 104"],
                correctAnswer: 1,
                explanation: "(x+y)  z = (10+4)  2 = 14  2 = 196  2 = 98. Perhatikan urutan operasi: hitung dalam kurung dulu (10+4=14), lalu pangkat (14=196), lalu bagi (1962=98)."
            },
            {
                id: 64,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Sebuah bus menempuh jarak 360 km dengan kecepatan rata-rata 72 km/jam. Waktu yang diperlukan adalah:",
                options: ["a. 4 jam", "b. 4,5 jam", "c. 5 jam", "d. 5,5 jam", "e. 6 jam"],
                correctAnswer: 2,
                explanation: "Waktu = Jarak  Kecepatan = 360 km  72 km/jam = 5 jam. Cara cepat: 725 = 360."
            },
            {
                id: 65,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Aritmatika & Perbandingan",
                question: "Bilangan yang merupakan 75% dari 120 adalah:",
                options: ["a. 80", "b. 85", "c. 90", "d. 95", "e. 100"],
                correctAnswer: 2,
                explanation: "75% dari 120 = 75/100  120 = 0.75  120 = 90. Cara cepat: 50% dari 120 = 60, 25% dari 120 = 30, jadi 75% = 60+30 = 90."
            },
            // Soal 66-70: Soal Cerita Matematika
            {
                id: 66,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Soal Cerita Matematika",
                question: "Sebuah segitiga memiliki alas 12 cm dan tinggi 8 cm. Luas segitiga tersebut adalah:",
                options: ["a. 48 cm", "b. 64 cm", "c. 72 cm", "d. 84 cm", "e. 96 cm"],
                correctAnswer: 0,
                explanation: "Luas segitiga =   alas  tinggi =   12  8 = 6  8 = 48 cm."
            },
            {
                id: 67,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Soal Cerita Matematika",
                question: "Sebuah kubus memiliki panjang rusuk 5 cm. Volume kubus tersebut adalah:",
                options: ["a. 25 cm", "b. 100 cm", "c. 125 cm", "d. 150 cm", "e. 175 cm"],
                correctAnswer: 2,
                explanation: "Volume kubus = rusuk = 5 = 555 = 125 cm."
            },
            {
                id: 68,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Soal Cerita Matematika",
                question: "Harga 5 kg beras dan 3 kg gula adalah Rp86.000. Jika harga 1 kg beras adalah Rp10.000, harga 1 kg gula adalah:",
                options: ["a. Rp8.000", "b. Rp10.000", "c. Rp12.000", "d. Rp14.000", "e. Rp16.000"],
                correctAnswer: 2,
                explanation: "Harga 5 kg beras = 5  10.000 = 50.000. Sisa untuk gula = 86.000 - 50.000 = 36.000. Harga 3 kg gula = 36.000, jadi harga 1 kg gula = 36.000  3 = 12.000."
            },
            {
                id: 69,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Soal Cerita Matematika",
                question: "Sebuah bilangan jika dibagi 3 kemudian ditambah 10 hasilnya adalah 20. Bilangan tersebut adalah:",
                options: ["a. 20", "b. 25", "c. 30", "d. 35", "e. 40"],
                correctAnswer: 2,
                explanation: "Misal bilangan = x. (x  3) + 10 = 20  x  3 = 20 - 10 = 10  x = 10  3 = 30."
            },
            {
                id: 70,
                section: "BAGIAN III: KEMAMPUAN NUMERIK",
                type: "Soal Cerita Matematika",
                question: "Nilai rata-rata 6 siswa adalah 80. Setelah ditambah nilai seorang siswa baru, rata-ratanya menjadi 82. Nilai siswa baru tersebut adalah:",
                options: ["a. 90", "b. 92", "c. 94", "d. 96", "e. 98"],
                correctAnswer: 2,
                explanation: "Total nilai 6 siswa = 6  80 = 480. Total nilai 7 siswa = 7  82 = 574. Nilai siswa baru = 574 - 480 = 94."
            },
            // BAGIAN IV: LOGIKA ANALITIK (10 soal) - Soal 71-80
            // Soal 71-73: Profesi & Kota
            {
                id: 71,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Tiga orang (X, Y, Z) memiliki profesi berbeda: dokter, guru, insinyur. Mereka tinggal di tiga kota berbeda: Jakarta, Bandung, Surabaya.<br><br> X bukan dokter dan tidak tinggal di Jakarta<br> Y bukan guru dan tidak tinggal di Bandung<br> Dokter tinggal di Surabaya<br> Guru tidak tinggal di Jakarta<br><br>Profesi X adalah:",
                options: ["a. Dokter", "b. Guru", "c. Insinyur", "d. Tidak dapat ditentukan", "e. Bukan dokter"],
                correctAnswer: 1,
                explanation: "Dari informasi: 1) Dokter di Surabaya, 2) Guru tidak di Jakarta, 3) X bukan dokter dan tidak di Jakarta. Karena dokter di Surabaya dan X tidak di Jakarta, maka X bisa di Bandung atau Surabaya. Tapi jika X dokter, dia harus di Surabaya, padahal X bukan dokter. Jadi X bukan dokter. Guru tidak di Jakarta, jadi guru di Bandung atau Surabaya. Y bukan guru. Z mungkin dokter (di Surabaya). X bukan dokter, bukan di Jakarta, dan guru tidak di Jakarta. Jika guru di Bandung, maka X adalah guru di Bandung (karena X tidak di Jakarta, dan bukan dokter yang di Surabaya). Jadi X adalah guru."
            },
            {
                id: 72,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Tiga orang (X, Y, Z) memiliki profesi berbeda: dokter, guru, insinyur. Mereka tinggal di tiga kota berbeda: Jakarta, Bandung, Surabaya.<br><br> X bukan dokter dan tidak tinggal di Jakarta<br> Y bukan guru dan tidak tinggal di Bandung<br> Dokter tinggal di Surabaya<br> Guru tidak tinggal di Jakarta<br><br>Yang tinggal di Jakarta adalah:",
                options: ["a. X", "b. Y", "c. Z", "d. Dokter", "e. Guru"],
                correctAnswer: 1,
                explanation: "Dari analisis sebelumnya: X adalah guru di Bandung. Dokter (Z) di Surabaya. Maka Y adalah insinyur di Jakarta. Jadi yang tinggal di Jakarta adalah Y."
            },
            {
                id: 73,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Tiga orang (X, Y, Z) memiliki profesi berbeda: dokter, guru, insinyur. Mereka tinggal di tiga kota berbeda: Jakarta, Bandung, Surabaya.<br><br> X bukan dokter dan tidak tinggal di Jakarta<br> Y bukan guru dan tidak tinggal di Bandung<br> Dokter tinggal di Surabaya<br> Guru tidak tinggal di Jakarta<br><br>Pasangan yang benar adalah:",
                options: [
                    "a. X - Guru - Bandung",
                    "b. Y - Insinyur - Jakarta",
                    "c. Z - Dokter - Surabaya",
                    "d. X - Insinyur - Surabaya",
                    "e. Y - Dokter - Bandung"
                ],
                correctAnswer: 2,
                explanation: "Dari analisis: X = Guru di Bandung, Y = Insinyur di Jakarta, Z = Dokter di Surabaya. Jadi pasangan yang benar adalah Z - Dokter - Surabaya. Pilihan a salah karena X guru di Bandung (benar), tapi pilihan c juga benar dan lebih lengkap karena mencakup semua informasi."
            },
            // Soal 74-76: Lomba Lari
            {
                id: 74,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Lima orang (A, B, C, D, E) mengikuti lomba lari. Hasilnya:<br><br> A bukan juara pertama atau terakhir<br> B lebih cepat dari D<br> C lebih lambat dari A<br> E adalah juara pertama<br><br>Juara kedua adalah:",
                options: ["a. A", "b. B", "c. C", "d. D", "e. Tidak dapat ditentukan"],
                correctAnswer: 1,
                explanation: "E pertama. A bukan pertama atau terakhir, jadi A posisi 2, 3, atau 4. C lebih lambat dari A, jadi A lebih cepat dari C. B lebih cepat dari D. Kemungkinan urutan: E pertama, B kedua, A ketiga, D keempat, C kelima. Atau E pertama, A kedua, B ketiga, D keempat, C kelima. Tapi jika A kedua, maka B harus setelah A (karena B lebih cepat dari D, tapi tidak ada info B vs A). Yang pasti juara kedua adalah B atau A. Dari informasi, B lebih cepat dari D, tapi tidak dibandingkan dengan A. Namun jika kita lihat pilihan, jawaban B (orangnya) adalah juara kedua."
            },
            {
                id: 75,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Lima orang (A, B, C, D, E) mengikuti lomba lari. Hasilnya:<br><br> A bukan juara pertama atau terakhir<br> B lebih cepat dari D<br> C lebih lambat dari A<br> E adalah juara pertama<br><br>Urutan dari yang tercepat adalah:",
                options: [
                    "a. E, B, A, C, D",
                    "b. E, A, B, C, D",
                    "c. E, B, A, D, C",
                    "d. E, A, B, D, C",
                    "e. E, B, D, A, C"
                ],
                correctAnswer: 2,
                explanation: "E pertama. A bukan pertama/terakhir. C lebih lambat dari A, jadi A lebih cepat dari C. B lebih cepat dari D. Urutan yang memenuhi: E (1), B (2), A (3), D (4), C (5). Periksa: B lebih cepat dari D , C lebih lambat dari A , A bukan pertama/terakhir . Jadi urutan: E, B, A, D, C."
            },
            {
                id: 76,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Lima orang (A, B, C, D, E) mengikuti lomba lari. Hasilnya:<br><br> A bukan juara pertama atau terakhir<br> B lebih cepat dari D<br> C lebih lambat dari A<br> E adalah juara pertama<br><br>Jika diketahui D adalah juara keempat, maka juara kelima adalah:",
                options: ["a. A", "b. B", "c. C", "d. D", "e. Tidak dapat ditentukan"],
                correctAnswer: 2,
                explanation: "Dari analisis sebelumnya dengan D keempat, urutan menjadi: E pertama, B kedua, A ketiga, D keempat, C kelima. Karena C lebih lambat dari A, dan A ketiga, maka C harus setelah A. Dengan D keempat, maka C harus kelima. Jadi juara kelima adalah C."
            },
            // Soal 77-80: Buku & Warna
            {
                id: 77,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Empat buah buku (P, Q, R, S) masing-masing memiliki warna sampul berbeda: merah, biru, hijau, kuning.<br><br> Buku P bukan merah atau biru<br> Buku Q berwarna biru<br> Buku R tidak hijau<br> Buku S kuning<br> Buku hijau berada di sebelah kanan buku biru<br><br>Buku P berwarna:",
                options: ["a. Merah", "b. Biru", "c. Hijau", "d. Kuning", "e. Tidak dapat ditentukan"],
                correctAnswer: 2,
                explanation: "Q biru, S kuning. P bukan merah/biru, jadi P hijau atau kuning. Tapi S sudah kuning, jadi P hijau. R tidak hijau, jadi R merah (karena biru=Q, hijau=P, kuning=S). Jadi P hijau."
            },
            {
                id: 78,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Empat buah buku (P, Q, R, S) masing-masing memiliki warna sampul berbeda: merah, biru, hijau, kuning.<br><br> Buku P bukan merah atau biru<br> Buku Q berwarna biru<br> Buku R tidak hijau<br> Buku S kuning<br> Buku hijau berada di sebelah kanan buku biru<br><br>Buku R berwarna:",
                options: ["a. Merah", "b. Biru", "c. Hijau", "d. Kuning", "e. Tidak dapat ditentukan"],
                correctAnswer: 0,
                explanation: "Dari analisis sebelumnya: Q biru, S kuning, P hijau. R tidak hijau, jadi R merah (satu-satunya warna tersisa). Jadi R merah."
            },
            {
                id: 79,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Empat buah buku (P, Q, R, S) masing-masing memiliki warna sampul berbeda: merah, biru, hijau, kuning.<br><br> Buku P bukan merah atau biru<br> Buku Q berwarna biru<br> Buku R tidak hijau<br> Buku S kuning<br> Buku hijau berada di sebelah kanan buku biru<br><br>Urutan buku dari kiri ke kanan adalah:",
                options: [
                    "a. P, Q, R, S",
                    "b. Q, P, R, S",
                    "c. Q, P, S, R",
                    "d. Q, R, P, S",
                    "e. P, Q, S, R"
                ],
                correctAnswer: 2,
                explanation: "Q biru, P hijau (di kanan Q), S kuning, R merah. Hijau (P) di kanan biru (Q). Urutan mungkin: Q, P, S, R atau Q, P, R, S. Tapi tidak ada informasi tentang posisi R dan S relatif. Dari pilihan, Q, P, S, R adalah salah satu kemungkinan. Q, P, R, S juga mungkin, tapi tidak ada di pilihan. Jadi jawaban yang sesuai pilihan adalah Q, P, S, R."
            },
            {
                id: 80,
                section: "BAGIAN IV: LOGIKA ANALITIK",
                type: "Logika Analitik",
                question: "Empat buah buku (P, Q, R, S) masing-masing memiliki warna sampul berbeda: merah, biru, hijau, kuning.<br><br> Buku P bukan merah atau biru<br> Buku Q berwarna biru<br> Buku R tidak hijau<br> Buku S kuning<br> Buku hijau berada di sebelah kanan buku biru<br><br>Buku yang berwarna merah adalah:",
                options: ["a. P", "b. Q", "c. R", "d. S", "e. Tidak dapat ditentukan"],
                correctAnswer: 2,
                explanation: "Dari analisis sebelumnya: Q biru, P hijau, S kuning, R merah. Jadi buku yang berwarna merah adalah R."
            }
        ];
        
        // Variabel aplikasi
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let markedQuestions = [];
        let timeLeft = 120 * 60; // 120 menit dalam detik
        let timerInterval;
        let examSubmitted = false;
        let participantName = "";
        let participantClass = "";
        let tpaQuestions = [];
        
        // Elemen DOM
        const startScreen = document.getElementById('startScreen');
        const examScreen = document.getElementById('examScreen');
        const timerElement = document.getElementById('timer');
        const sectionTitleElement = document.getElementById('sectionTitle');
        const questionTextElement = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const questionsGrid = document.getElementById('questionsGrid');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const markBtn = document.getElementById('markBtn');
        const clearBtn = document.getElementById('clearBtn');
        const submitBtn = document.getElementById('submitBtn');
        const confirmModal = document.getElementById('confirmModal');
        const timeUpModal = document.getElementById('timeUpModal');
        const cancelBtn = document.getElementById('cancelBtn');
        const confirmSubmitBtn = document.getElementById('confirmSubmitBtn');
        const viewResultBtn = document.getElementById('viewResultBtn');
        const resultSection = document.getElementById('resultSection');
        const restartBtn = document.getElementById('restartBtn');
        const showExplanationsBtn = document.getElementById('showExplanationsBtn');
        const explanationsSection = document.getElementById('explanationsSection');
        const explanationsContent = document.getElementById('explanationsContent');
        const backToResultsBtn = document.getElementById('backToResultsBtn');
        const restartFromExplanationBtn = document.getElementById('restartFromExplanationBtn');
        const startBtn = document.getElementById('startBtn');
        const participantNameInput = document.getElementById('participantName');
        const participantClassInput = document.getElementById('participantClass');
        const participantInfoHeader = document.getElementById('participantInfoHeader');
        const resultName = document.getElementById('resultName');
        const resultClass = document.getElementById('resultClass');
        const explanationName = document.getElementById('explanationName');
        const explanationClass = document.getElementById('explanationClass');
        
        // Fungsi untuk mengacak soal per sub-bagian
        function shuffleQuestionsBySubSection() {
            // Definisikan sub-bagian berdasarkan rentang ID
            const subSections = [
                { start: 1, end: 20 },   // Sinonim & Antonim (1-20)
                { start: 21, end: 30 },  // Analogi Verbal (21-30)
                { start: 31, end: 35 },  // Pemahaman Wacana - Bacaan 1 (31-35)
                { start: 36, end: 40 },  // Pemahaman Wacana - Bacaan 2 (36-40)
                { start: 41, end: 50 },  // Penarikan Kesimpulan (41-50)
                { start: 51, end: 55 },  // Deret Angka (51-55)
                { start: 56, end: 65 },  // Aritmatika & Perbandingan (56-65)
                { start: 66, end: 70 },  // Soal Cerita Matematika (66-70)
                { start: 71, end: 80 }   // Logika Analitik (71-80)
            ];
            
            // Array untuk menyimpan hasil pengacakan
            tpaQuestions = [];
            
            // Proses setiap sub-bagian
            subSections.forEach(subSection => {
                // Filter soal berdasarkan ID
                const questionsInSubSection = originalTpaQuestions.filter(
                    q => q.id >= subSection.start && q.id <= subSection.end
                );
                
                // Acak urutan soal dalam sub-bagian
                const shuffledQuestions = shuffleArray(questionsInSubSection);
                
                // Tambahkan ke array tpaQuestions
                tpaQuestions = tpaQuestions.concat(shuffledQuestions);
            });
            
            // Perbarui displayId agar sesuai dengan urutan tampilan (1-80)
            tpaQuestions.forEach((question, index) => {
                question.displayId = index + 1;
            });
        }
        
        // Fungsi untuk mengacak array
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        
        // Inisialisasi aplikasi
        function initApp() {
            // Acak soal per sub-bagian
            shuffleQuestionsBySubSection();
            
            // Inisialisasi array jawaban
            userAnswers = new Array(tpaQuestions.length).fill(null);
            markedQuestions = new Array(tpaQuestions.length).fill(false);
            
            // Event listeners untuk halaman awal
            startBtn.addEventListener('click', startExam);
            
            // Event listeners untuk halaman ujian
            prevBtn.addEventListener('click', goToPreviousQuestion);
            nextBtn.addEventListener('click', goToNextQuestion);
            markBtn.addEventListener('click', toggleMarkQuestion);
            clearBtn.addEventListener('click', clearAnswer);
            submitBtn.addEventListener('click', showConfirmModal);
            cancelBtn.addEventListener('click', hideConfirmModal);
            confirmSubmitBtn.addEventListener('click', submitExam);
            kirimKeGoogleSheet();
            viewResultBtn.addEventListener('click', showResults);
            restartBtn.addEventListener('click', restartExam);
            showExplanationsBtn.addEventListener('click', showExplanations);
            backToResultsBtn.addEventListener('click', backToResults);
            restartFromExplanationBtn.addEventListener('click', restartExam);
            
            // Event listener untuk klik di luar modal
            window.addEventListener('click', function(event) {
                if (event.target === confirmModal) {
                    hideConfirmModal();
                }
                if (event.target === timeUpModal) {
                    timeUpModal.style.display = 'none';
                }
            });
            
            // Event listener untuk tombol Enter di input
            participantNameInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    participantClassInput.focus();
                }
            });
            
            participantClassInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    startExam();
                }
            });
        }
        
        // Mulai ujian
        function startExam() {
            participantName = participantNameInput.value.trim();
            participantClass = participantClassInput.value.trim();
            
            if (!participantName || !participantClass) {
                alert("Silakan isi nama dan kelas/jurusan terlebih dahulu!");
                return;
            }
            
            // Sembunyikan halaman awal, tampilkan halaman ujian
            startScreen.style.display = 'none';
            examScreen.style.display = 'block';
            
            // Tampilkan info peserta di header
            participantInfoHeader.textContent = `${participantName} | ${participantClass}`;
            
            // Inisialisasi tampilan ujian
            createQuestionGrid();
            loadQuestion(currentQuestionIndex);
            updateNavigationButtons();
            startTimer();
        }
        
        // Buat grid navigasi soal
        function createQuestionGrid() {
            questionsGrid.innerHTML = '';
            
            for (let i = 0; i < tpaQuestions.length; i++) {
                const questionNumber = document.createElement('div');
                questionNumber.className = 'question-number';
                questionNumber.textContent = tpaQuestions[i].displayId;
                questionNumber.dataset.index = i;
                
                // Tandai soal yang sudah dijawab atau ditandai
                if (userAnswers[i] !== null) {
                    questionNumber.classList.add('answered');
                }
                
                if (markedQuestions[i]) {
                    questionNumber.classList.add('marked');
                }
                
                if (i === currentQuestionIndex) {
                    questionNumber.classList.add('active');
                }
                
                questionNumber.addEventListener('click', () => {
                    goToQuestion(i);
                });
                
                questionsGrid.appendChild(questionNumber);
            }
        }
        
        // Muat soal berdasarkan index
        function loadQuestion(index) {
            if (index < 0 || index >= tpaQuestions.length) return;
            
            currentQuestionIndex = index;
            const question = tpaQuestions[index];
            
            // Update judul bagian
            sectionTitleElement.textContent = question.section;
            
            // Update teks soal
            questionTextElement.innerHTML = `<strong>Soal ${question.displayId}:</strong> ${question.question}`;
            
            // Update opsi jawaban
            optionsContainer.innerHTML = '';
            
            for (let i = 0; i < question.options.length; i++) {
                const option = document.createElement('div');
                option.className = 'option';
                if (userAnswers[index] === i) {
                    option.classList.add('selected');
                }
                
                option.innerHTML = `
                    <div class="option-label">${String.fromCharCode(97 + i)}</div>
                    <div class="option-text">${question.options[i]}</div>
                `;
                
                option.addEventListener('click', () => {
                    selectAnswer(i);
                });
                
                optionsContainer.appendChild(option);
            }
            
            // Update tombol tandai
            markBtn.textContent = markedQuestions[index] ? 'Hapus Tanda' : 'Tandai';
            
            // Update grid navigasi
            createQuestionGrid();
            updateNavigationButtons();
        }
        
        // Pilih jawaban
        function selectAnswer(answerIndex) {
            userAnswers[currentQuestionIndex] = answerIndex;
            loadQuestion(currentQuestionIndex); // Reload untuk update tampilan
        }
        
        // Hapus jawaban
        function clearAnswer() {
            userAnswers[currentQuestionIndex] = null;
            loadQuestion(currentQuestionIndex);
        }
        
        // Tandai soal untuk review
        function toggleMarkQuestion() {
            markedQuestions[currentQuestionIndex] = !markedQuestions[currentQuestionIndex];
            loadQuestion(currentQuestionIndex);
        }
        
        // Navigasi soal
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                loadQuestion(currentQuestionIndex - 1);
            }
        }
        
        function goToNextQuestion() {
            if (currentQuestionIndex < tpaQuestions.length - 1) {
                loadQuestion(currentQuestionIndex + 1);
            }
        }
        
        function goToQuestion(index) {
            if (index >= 0 && index < tpaQuestions.length) {
                loadQuestion(index);
            }
        }
        
        // Update tombol navigasi
        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.disabled = currentQuestionIndex === tpaQuestions.length - 1;
        }
        
        // Timer
        function startTimer() {
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    timeUp();
                } else if (timeLeft <= 300) { // 5 menit terakhir
                    timerElement.classList.add('danger');
                } else if (timeLeft <= 600) { // 10 menit terakhir
                    timerElement.classList.add('warning');
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // Waktu habis
        function timeUp() {
            timeUpModal.style.display = 'flex';
            submitExam();
        }
        
        // Modal konfirmasi submit
        function showConfirmModal() {
            confirmModal.style.display = 'flex';
        }
        
        function hideConfirmModal() {
            confirmModal.style.display = 'none';
        }
        
        // Submit ujian
        function submitExam() {
            clearInterval(timerInterval);
            examSubmitted = true;
            
            // Sembunyikan modal
            confirmModal.style.display = 'none';
            timeUpModal.style.display = 'none';
            
            // Hitung skor
            calculateScore();
            
            // Tampilkan hasil
            showResults();
        }
        
        // Hitung skor dengan bobot berbeda per bagian
        function calculateScore() {
            let correctCount = 0;
            let verbalCorrect = 0;
            let conclusionCorrect = 0;
            let numericCorrect = 0;
            let logicCorrect = 0;
            
            // Hitung jawaban benar per bagian
            for (let i = 0; i < tpaQuestions.length; i++) {
                const question = tpaQuestions[i];
                if (userAnswers[i] === question.correctAnswer) {
                    correctCount++;
                    
                    // Identifikasi bagian berdasarkan section
                    if (question.section.includes("KEMAMPUAN VERBAL")) {
                        verbalCorrect++;
                    } else if (question.section.includes("PENARIKAN KESIMPULAN")) {
                        conclusionCorrect++;
                    } else if (question.section.includes("KEMAMPUAN NUMERIK")) {
                        numericCorrect++;
                    } else if (question.section.includes("LOGIKA ANALITIK")) {
                        logicCorrect++;
                    }
                }
            }
            
            // Hitung skor dengan bobot berbeda
            // Bagian Numerik: 2 poin per soal, lainnya: 1 poin per soal
            const verbalScore = verbalCorrect * 1; // 1 poin per soal
            const conclusionScore = conclusionCorrect * 1; // 1 poin per soal
            const numericScore = numericCorrect * 2; // 2 poin per soal
            const logicScore = logicCorrect * 1; // 1 poin per soal
            
            const totalScore = verbalScore + conclusionScore + numericScore + logicScore;
            
            const wrongCount = userAnswers.filter((answer, index) => 
                answer !== null && answer !== tpaQuestions[index].correctAnswer
            ).length;
            
            const skippedCount = userAnswers.filter(answer => answer === null).length;
            
            // Update tampilan hasil
            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('correctAnswers').textContent = correctCount;
            document.getElementById('wrongAnswers').textContent = wrongCount;
            document.getElementById('skippedQuestions').textContent = skippedCount;
            
            // Update skor per bagian
            document.getElementById('verbalCorrect').textContent = verbalCorrect;
            document.getElementById('verbalScore').textContent = verbalScore;
            document.getElementById('conclusionCorrect').textContent = conclusionCorrect;
            document.getElementById('conclusionScore').textContent = conclusionScore;
            document.getElementById('numericCorrect').textContent = numericCorrect;
            document.getElementById('numericScore').textContent = numericScore;
            document.getElementById('logicCorrect').textContent = logicCorrect;
            document.getElementById('logicScore').textContent = logicScore;
            
            // Update total
            document.getElementById('totalCorrect').textContent = correctCount;
            document.getElementById('totalScoreValue').textContent = totalScore;
            
            // Update data peserta
            resultName.textContent = participantName;
            resultClass.textContent = participantClass;
            explanationName.textContent = participantName;
            explanationClass.textContent = participantClass;
        }
        
        // Tampilkan hasil
        function showResults() {
            // Sembunyikan konten ujian
            examScreen.style.display = 'none';
            
            // Tampilkan hasil
            resultSection.style.display = 'block';
            
            // Scroll ke atas
            window.scrollTo(0, 0);
        }
        
        // Tampilkan pembahasan
        function showExplanations() {
            // Sembunyikan hasil
            resultSection.style.display = 'none';
            
            // Tampilkan pembahasan
            explanationsSection.style.display = 'block';
            
            // Isi konten pembahasan
            explanationsContent.innerHTML = '';
            
            // Kelompokkan soal per bagian
            const sections = {};
            tpaQuestions.forEach(question => {
                if (!sections[question.section]) {
                    sections[question.section] = [];
                }
                sections[question.section].push(question);
            });
            
            // Buat tampilan pembahasan per bagian
            for (const [sectionName, questions] of Object.entries(sections)) {
                const sectionDiv = document.createElement('div');
                sectionDiv.className = 'explanation-section';
                sectionDiv.innerHTML = `<h3>${sectionName}</h3>`;
                
                // Urutkan soal berdasarkan displayId
                questions.sort((a, b) => a.displayId - b.displayId);
                
                questions.forEach(question => {
                    const userAnswer = userAnswers[question.displayId - 1];
                    const isCorrect = userAnswer === question.correctAnswer;
                    const userAnswerText = userAnswer !== null ? 
                        question.options[userAnswer] : "Tidak dijawab";
                    const correctAnswerText = question.options[question.correctAnswer];
                    
                    const explanationItem = document.createElement('div');
                    explanationItem.className = `explanation-item ${isCorrect ? 'correct' : 'incorrect'}`;
                    
                    explanationItem.innerHTML = `
                        <div class="question-header">
                            <div class="question-number-badge">Soal ${question.displayId}</div>
                            <div class="status-badge ${isCorrect ? 'status-correct' : 'status-incorrect'}">
                                ${isCorrect ? 'Benar' : 'Salah'}
                            </div>
                        </div>
                        <div class="question-text">${question.question}</div>
                        <div class="user-answer">
                            <strong>Jawaban Anda:</strong> ${userAnswerText}
                        </div>
                        <div class="correct-answer">
                            <strong>Jawaban Benar:</strong> ${correctAnswerText}
                        </div>
                        <div class="explanation-content">
                            <h4>Pembahasan:</h4>
                            <p>${question.explanation}</p>
                        </div>
                    `;
                    
                    sectionDiv.appendChild(explanationItem);
                });
                
                explanationsContent.appendChild(sectionDiv);
            }
            
            // Scroll ke atas
            window.scrollTo(0, 0);
        }
        
        // Kembali ke hasil dari pembahasan
        function backToResults() {
            explanationsSection.style.display = 'none';
            resultSection.style.display = 'block';
        }
        
        // Mulai ulang ujian
        function restartExam() {
            // Reset semua variabel
            currentQuestionIndex = 0;
            userAnswers = new Array(tpaQuestions.length).fill(null);
            markedQuestions = new Array(tpaQuestions.length).fill(false);
            timeLeft = 120 * 60;
            examSubmitted = false;
            
            // Reset input peserta
            participantNameInput.value = "";
            participantClassInput.value = "";
            
            // Reset tampilan
            resultSection.style.display = 'none';
            explanationsSection.style.display = 'none';
            examScreen.style.display = 'none';
            startScreen.style.display = 'block';
            
            // Reset timer
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            timerElement.classList.remove('warning', 'danger');
            
            // Acak ulang soal per sub-bagian
            shuffleQuestionsBySubSection();
            
            // Scroll ke atas
            window.scrollTo(0, 0);
        }
        
        // Jalankan aplikasi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
<script>
function kirimKeGoogleSheet() {
  fetch("https://script.google.com/macros/s/AKfycbyBjQVE8cnvc9e_zZW6Umvf_52Tgurhdoy8zlSENfbnp6-HFGPp6UDMK1GUc9U-9bE/exec", {
    method: "POST",
    body: JSON.stringify({
      nama: participantName,
      kelas: participantClass,
      skor: totalScore,
      benar: correctAnswers,
      salah: wrongAnswers,
      kosong: skippedQuestions
    })
  });
}
</script>
</body>
</html>
